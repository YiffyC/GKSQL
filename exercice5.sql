--SERIE1
--5.1.1
SELECT SUM(COUT)
FROM PROJET;

--5.1.2
SELECT MIN(DATENT), MAX(DATENT)
FROM EMPLOI
WHERE CODEPT = 3;

--5.1.3
SELECT COUNT(DISTINCT FONCTION)
FROM AFFECT;

--5.1.4
SELECT COUNT(MLE)
FROM INGENIEUR
WHERE VILLE = 'MONTPELIER'
;

--5.1.5
SELECT AVG(PVENTE)
FROM AFFECT
WHERE CODPRO = 120
AND DATDEB < '2008-01-01'
AND (DATFIN IS NULL OR DATFIN > '2009-01-01')
;

--5.1.6
SELECT CODEPT, COUNT(*)
FROM EMPLOI
WHERE DATENT < '2008-01-01'
AND (DATSOR IS NULL OR DATSOR > '2009-01-01')
GROUP BY CODEPT;

--5.1.7
SELECT CODPRO, AVG(PVENTE)
FROM AFFECT
WHERE DATDEB < '2008-01-01'
AND (DATFIN IS NULL OR DATFIN > '2009-01-01')
GROUP BY CODPRO
HAVING AVG(PVENTE) >= 2500;

--5.1.8
SELECT MLE, CODPRO
FROM AFFECT
WHERE DATDEB < '2017-12-31'
AND  DATDEB >
              (
                SELECT MAX(DATENT)
                FROM EMPLOI
                WHERE DATENT < '2017-12-31'
              )
ORDER BY MLE
;
